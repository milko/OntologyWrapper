<html>
    <head>
        <script
            type="text/javascript"
            src="../../js/jquery-1.4.2.min.js">
        </script>
        <script
            type="text/javascript"
            src="../../syntax_highlighter/scripts/shCore.js">
        </script>
        <script
            type="text/javascript"
            src="../../syntax_highlighter/scripts/shBrushJScript.js">
        </script>
        <script
            type="text/javascript"
            src="../../syntax_highlighter/scripts/shBrushPhp.js">
        </script>
        <script
            type="text/javascript"
            src="../../syntax_highlighter/scripts/shBrushXml.js">
        </script>
        <link
            href="../../syntax_highlighter/styles/shCore.css" rel="stylesheet"
            type="text/css"
        />
        <link
            href="../../syntax_highlighter/styles/shCoreEclipse.css"
            rel="stylesheet" type="text/css"
        />
        <link
            href="../../syntax_highlighter/styles/shThemeWordpress.css"
            rel="stylesheet" type="text/css"
        />
    </head>
    <body>
        <pre class="brush: php">&lt;?php

/**
 * ContainerObject.php
 *
 * This file contains the definition of the {@link ContainerObject} class.
 */

namespace OntologyWrapper;

/*=======================================================================================
 *																						*
 *									ContainerObject.php									*
 *																						*
 *======================================================================================*/

/**
 * Container object
 *
 * This class is the ancestor of classes that define objects that handle structured data and
 * that are persistent.
 *
 * The class extends &lt;code&gt;{@link ArrayObject}&lt;/code&gt; by treating the inherited array as the
 * persistent store and all other data members as run-time data. The convention is that
 * items stored in the array part of the object are called &lt;em&gt;offsets&lt;/em&gt; and are
 * considered &lt;em&gt;persistent&lt;/em&gt;, while all other data members are called &lt;em&gt;members&lt;/em&gt;
 * and are considered &lt;em&gt;run-time&lt;/em&gt; data.
 *
 * This class implements a framework that governs tha management of the object's persistent
 * data. No offset may hold the &lt;tt&gt;NULL&lt;/tt&gt; value, setting an offset with &lt;tt&gt;NULL&lt;/tt&gt;
 * value is equivalent to &lt;em&gt;deleting the offset&lt;/em&gt;.
 *
 * Retrieving non-existant offsets will &lt;em&gt;not&lt;/em&gt; generate a warning, but only return
 * &lt;tt&gt;NULL&lt;/tt&gt;.
 *
 * The class features a series of methods that derived classes may use to customise the
 * behaviour of the offset management methods:
 *
 * &lt;ul&gt;
 *	&lt;li&gt;&lt;tt&gt;{@link preOffsetExists()}&lt;/tt&gt;: This method is called &lt;i&gt;before&lt;/i&gt; the
 *		{@link offsetExists()} method with the offset passed as a reference parameter, the
 *		method can be used to change the value of the offset or to provide a custom result:
 *		if the method returns &lt;tt&gt;NULL&lt;/tt&gt;, {@link offsetExists()} will be called; if the
 *		method returns any other type of value, this will be returned and
 *		{@link offsetExists()} will be skipped.
 *	&lt;li&gt;&lt;tt&gt;{@link preOffsetGet()}&lt;/tt&gt;: This is called &lt;i&gt;before&lt;/i&gt; the
 *		{@link offsetGet()} method with the offset passed as a reference parameter, the
 *		method can be used to change the value of the offset or to provide a custom result:
 *		if the method returns &lt;tt&gt;NULL&lt;/tt&gt;, {@link offsetGet()} will be called; if the
 *		method returns any other type of value, this will be returned and
 *		{@link offsetGet()} will be skipped.
 *	&lt;li&gt;&lt;tt&gt;{@link preOffsetSet()}&lt;/tt&gt;: This is called &lt;i&gt;before&lt;/i&gt; the
 *		{@link offsetSet()} method with the offset and value passed as reference parameters,
 *		the method can be used to change the offset or the value: if the method returns
 *		&lt;tt&gt;NULL&lt;/tt&gt;, {@link offsetSet()} will be called; if the method returns any other
 *		type of value, the {@link offsetSet()} will be skipped.
 *	&lt;li&gt;&lt;tt&gt;{@link postOffsetSet()}&lt;/tt&gt;: This is called &lt;i&gt;after&lt;/i&gt; the
 *		{@link offsetSet()} method with the offset and value passed as reference parameters,
 *		the method can be used to set status or statistical variables, it will only be
 *		called if the {@link offsetSet()} method was called.
 *	&lt;li&gt;&lt;tt&gt;{@link preOffsetUnset()}&lt;/tt&gt;: This is called &lt;i&gt;before&lt;/i&gt; the
 *		{@link offsetUnset()} method with the offset passed as a reference parameter, the
 *		method can be used to change the offset: if the method returns &lt;tt&gt;NULL&lt;/tt&gt;,
 *		{@link offsetUnset()} will be called; if the method returns any other type of value,
 *		the {@link offsetUnset()} will be skipped.
 *	&lt;li&gt;&lt;tt&gt;{@link postOffsetUnset()}&lt;/tt&gt;: This is called &lt;i&gt;after&lt;/i&gt; the
 *		{@link offsetUnset()} method with the offset passed as a reference parameter, the
 *		method can be used to set status or statistical variables, it will only be called if
 *		the {@link offsetUnset()} method was called.
 * &lt;/ul&gt;
 *
 * The class features a series of methods that are useful for handling the persistent data
 * as a whole:
 *
 * &lt;ul&gt;
 *	&lt;li&gt;&lt;em&gt;{@link arrayKeys()}&lt;/em&gt;: This method is the equivalent of the
 *		{@link array_keys()} function.
 *	&lt;li&gt;&lt;em&gt;{@link arrayValues()}&lt;/em&gt;: This method is the equivalent of the
 *		{@link array_values()} function.
 * &lt;/ul&gt;
 *
 * The class features a static method, {@link Object2Array}, that can be used to
 * convert a structure of nested {@link ArrayObject} instances into a nested array, this
 * will be useful when normalising objects before persisting.
 *
 * This class uses the {@link Accessors} trait to provide a common framework to methods that
 * manage data properties and offsets.
 *
 *	@author		Milko A. &Scaron;kofiƒç &lt;m.skofic@cgiar.org&gt;
 *	@version	1.00 10/01/2014
 */
class ContainerObject extends \ArrayObject
{
	/**
	 * Accessors trait.
	 *
	 * We use this trait to provide a common framework for methods that manage properties
	 * and offsets.
	 */
	use	traits\Accessors;

		

/*=======================================================================================
 *																						*
 *								PUBLIC ARRAY ACCESS INTERFACE							*
 *																						*
 *======================================================================================*/


	 
	/*===================================================================================
	 *	offsetExists																	*
	 *==================================================================================*/

	/**
	 * Check if an offset exists
	 *
	 * We overload this method to call the preflight method: if it returns &lt;tt&gt;NULL&lt;/tt&gt; we
	 * call the parent method; if not, we return the received value.
	 *
	 * @param mixed					$theOffset			Offset.
	 *
	 * @access public
	 * @return boolean				&lt;tt&gt;TRUE&lt;/tt&gt; the offset exists.
	 *
	 * @uses preOffsetExists()
	 */
	public function offsetExists( $theOffset )
	{
		//
		// Call preflight.
		//
		$value = $this-&gt;preOffsetExists( $theOffset );
		if( $value !== NULL )
			return $value;															// ==&gt;
		
		return parent::offsetExists( $theOffset );									// ==&gt;
	
	} // offsetExists.

	 
	/*===================================================================================
	 *	offsetGet																		*
	 *==================================================================================*/

	/**
	 * Return a value at a given offset
	 *
	 * We overload this method to call the preflight method: if it returns &lt;tt&gt;NULL&lt;/tt&gt; we
	 * call the parent method; if not, we return the received value.
	 *
	 * We also overload this method to handle unmatched offsets: we prevent warnings from
	 * being issued and return &lt;tt&gt;NULL&lt;/tt&gt;.
	 *
	 * @param mixed					$theOffset			Offset.
	 *
	 * @access public
	 * @return mixed				Offset value or &lt;tt&gt;NULL&lt;/tt&gt;.
	 *
	 * @uses preOffsetGet()
	 */
	public function offsetGet( $theOffset )
	{
		//
		// Call preflight.
		//
		$value = $this-&gt;preOffsetGet( $theOffset );
		if( $value !== NULL )
			return $value;															// ==&gt;
		
		//
		// Matched offset.
		//
		if( parent::offsetExists( $theOffset ) )
			return parent::offsetGet( $theOffset );									// ==&gt;
		
		return NULL;																// ==&gt;
	
	} // offsetGet.

	 
	/*===================================================================================
	 *	offsetSet																		*
	 *==================================================================================*/

	/**
	 * Set a value at a given offset
	 *
	 * We overload this method to call the preflight and postflight methods: if the
	 * preflight method returns &lt;tt&gt;NULL&lt;/tt&gt; we call the parent method; if not, we stop.
	 *
	 * We also overload this method to handle &lt;tt&gt;NULL&lt;/tt&gt; &lt;em&gt;values&lt;/em&gt;: in that case we
	 * delete the offset.
	 *
	 * @param string				$theOffset			Offset.
	 * @param mixed					$theValue			Value to set at offset.
	 *
	 * @access public
	 *
	 * @uses preOffsetSet()
	 * @uses postOffsetSet()
	 * @uses offsetUnset()
	 */
	public function offsetSet( $theOffset, $theValue )
	{
		//
		// Skip deletions.
		//
		if( $theValue !== NULL )
		{
			//
			// Call preflight.
			//
			if( $this-&gt;preOffsetSet( $theOffset, $theValue ) === NULL )
			{
				//
				// Set value.
				//
				parent::offsetSet( $theOffset, $theValue );
				
				//
				// Call postflight.
				//
				$this-&gt;postOffsetSet( $theOffset, $theValue );
			
			} // Preflight passed.
		
		} // Not deleting.
		
		//
		// Handle delete.
		//
		else
			$this-&gt;offsetUnset( $theOffset );
	
	} // offsetSet.

	 
	/*===================================================================================
	 *	offsetUnset																		*
	 *==================================================================================*/

	/**
	 * Reset a value at a given offset
	 *
	 * We overload this method to call the preflight and postflight methods: if the
	 * preflight method returns &lt;tt&gt;NULL&lt;/tt&gt; we call the parent method; if not, we stop.
	 *
	 * We also overload this method to prevent warnings on unmatched offsets.
	 *
	 * @param string				$theOffset			Offset.
	 *
	 * @access public
	 *
	 * @uses preOffsetUnset()
	 * @uses postOffsetUnset()
	 */
	public function offsetUnset( $theOffset )
	{
		//
		// Call preflight.
		//
		if( $this-&gt;preOffsetUnset( $theOffset ) === NULL )
		{
			//
			// Delete value.
			//
			if( parent::offsetExists( $theOffset ) )
				parent::offsetUnset( $theOffset );
			
			//
			// Call postflight.
			//
			$this-&gt;postOffsetUnset( $theOffset );
		
		} // Postflight passed.
	
	} // offsetUnset.

		

/*=======================================================================================
 *																						*
 *								PUBLIC ARRAY UTILITY INTERFACE							*
 *																						*
 *======================================================================================*/


	 
	/*===================================================================================
	 *	arrayKeys																		*
	 *==================================================================================*/

	/**
	 * Return object's offsets
	 *
	 * This method has the same function as the PHP function {@link array_keys()}, it will
	 * return all the object's offset keys as an array.
	 *
	 * @access public
	 * @return array				List of object offsets.
	 *
	 * @uses getArrayCopy()
	 */
	public function arrayKeys()				{	return array_keys( $this-&gt;getArrayCopy() );	}

	 
	/*===================================================================================
	 *	arrayValues																		*
	 *==================================================================================*/

	/**
	 * Return object's offset values
	 *
	 * This method has the same function as the PHP function {@link array_values()}, it
	 * will return all the object's offset values as an array.
	 *
	 * @access public
	 * @return array				List of object offset values.
	 *
	 * @uses getArrayCopy()
	 */
	public function arrayValues()		{	return array_values( $this-&gt;getArrayCopy() );	}

	 

/*=======================================================================================
 *																						*
 *							STATIC SERIALISATION INTERFACE								*
 *																						*
 *======================================================================================*/


	 
	/*===================================================================================
	 *	Object2Array																	*
	 *==================================================================================*/

	/**
	 * &lt;h4&gt;Convert object to array&lt;/h4&gt;
	 *
	 * This method can be used to obtain an array of arrays from a nested structure.
	 *
	 * The method expects as the first parameter a reference to an {@link ArrayObject} or to
	 * an array, it will convert the provided parameter to an array and traverse it,
	 * converting recursively any {@link ArrayObject} instance into an array.
	 *
	 * The method accepts the following parameters:
	 *
	 * &lt;ul&gt;
	 *	&lt;li&gt;&lt;tt&gt;$theSource&lt;/tt&gt;: Source structure reference (&lt;em&gt;read-only&lt;/em&gt;).
	 *	&lt;li&gt;&lt;tt&gt;$theDestination&lt;/tt&gt;: Destination array reference.
	 * &lt;/ul&gt;
	 *
	 * @param reference				$theSource			Reference to the source structure.
	 * @param reference				$theDestination		Reference to the destination array.
	 *
	 * @static
	 *
	 * @throws Exception
	 */
	static function Object2Array( &amp;$theSource, &amp;$theDestination )
	{
		//
		// Init destination.
		//
		if( ! is_array( $theDestination ) )
			$theDestination = Array();
		
		//
		// Convert source.
		//
		if( $theSource instanceof \ArrayObject )
			$theSource = $theSource-&gt;getArrayCopy();
		
		//
		// Check if array.
		//
		elseif( ! is_array( $theSource ) )
			throw new \Exception( &quot;Bug: received source parameter of type: [&quot;
								.gettype( $theSource )
								.&quot;].&quot; );										// !@! ==&gt;
		
		//
		// Iterate source array.
		//
		$keys = array_keys( $theSource );
		foreach( $keys as $key )
		{
			//
			// Recurse structures.
			//
			if( is_array( $theSource[ $key ] )
			 || ($theSource[ $key ] instanceof \ArrayObject) )
				static::Object2Array( $theSource[ $key ], $theDestination[ $key ] );
			
			//
			// Handle scalars.
			//
			else
				$theDestination[ $key ] = $theSource[ $key ];
		
		} // Iterating source.
	
	} // Object2Array.

		

/*=======================================================================================
 *																						*
 *							PROTECTED ARRAY ACCESS INTERFACE							*
 *																						*
 *======================================================================================*/


	 
	/*===================================================================================
	 *	preOffsetExists																	*
	 *==================================================================================*/

	/**
	 * Handle offset before checking it
	 *
	 * This method can be used to manage the offset before passing it to the inherited
	 * {@link ArrayObject::OffsetExists()} method.
	 *
	 * The method provides the offset as a reference, if the method returns &lt;tt&gt;NULL&lt;/tt&gt;
	 * it means that the offset must be passed to the inherited
	 * {@link ArrayObject::OffsetExists()}; if the method returns any other value, this will
	 * be returned and the inherited {@link ArrayObject::OffsetExists()} will be skipped.
	 *
	 * In this class we do nothing.
	 *
	 * @param reference				$theOffset			Offset reference.
	 *
	 * @access protected
	 * @return mixed				&lt;tt&gt;NULL&lt;/tt&gt; check offset, other, return.
	 */
	protected function preOffsetExists( &amp;$theOffset )					{	return NULL;	}

	 
	/*===================================================================================
	 *	preOffsetGet																	*
	 *==================================================================================*/

	/**
	 * Handle offset before getting it
	 *
	 * This method can be used to manage the offset before passing it to the inherited
	 * {@link ArrayObject::OffsetGet()} method.
	 *
	 * The method provides the offset as a reference, if the method returns &lt;tt&gt;NULL&lt;/tt&gt;
	 * it means that the offset must be passed to the inherited
	 * {@link ArrayObject::OffsetGet()}; if the method returns any other value, this must be
	 * returned and the inherited {@link ArrayObject::OffsetGet()} skipped.
	 *
	 * In this class we do nothing.
	 *
	 * @param reference				$theOffset			Offset reference.
	 *
	 * @access protected
	 * @return mixed				&lt;tt&gt;NULL&lt;/tt&gt; get offset value, other, return.
	 */
	protected function preOffsetGet( &amp;$theOffset )						{	return NULL;	}

	 
	/*===================================================================================
	 *	preOffsetSet																	*
	 *==================================================================================*/

	/**
	 * Handle offset and value before setting it
	 *
	 * This method can be used to manage the offset before passing it to the inherited
	 * {@link ArrayObject::OffsetSet()} method.
	 *
	 * The method provides the offset and value as references, if the method returns
	 * &lt;tt&gt;NULL&lt;/tt&gt; it means that the offset and value must be passed to the inherited
	 * {@link ArrayObject::OffsetSet()}; if the method returns any other value, this means
	 * that the inherited {@link ArrayObject::OffsetSet()} should be skipped.
	 *
	 * In this class we do nothing.
	 *
	 * @param reference				$theOffset			Offset reference.
	 * @param reference				$theValue			Offset value reference.
	 *
	 * @access protected
	 * @return mixed				&lt;tt&gt;NULL&lt;/tt&gt; set offset value, other, return.
	 */
	protected function preOffsetSet( &amp;$theOffset, &amp;$theValue )			{	return NULL;	}

	 
	/*===================================================================================
	 *	postOffsetSet																	*
	 *==================================================================================*/

	/**
	 * Handle offset and value after setting it
	 *
	 * This method can be used to manage the object after calling the
	 * {@link ArrayObject::OffsetSet()} method.
	 *
	 * In this class we do nothing.
	 *
	 * @param reference				$theOffset			Offset reference.
	 * @param reference				$theValue			Offset value reference.
	 *
	 * @access protected
	 */
	protected function postOffsetSet( &amp;$theOffset, &amp;$theValue )							   {}

	 
	/*===================================================================================
	 *	preOffsetUnset																	*
	 *==================================================================================*/

	/**
	 * Handle offset and value before deleting it
	 *
	 * This method can be used to manage the offset before passing it to the inherited
	 * {@link ArrayObject::OffsetUnset()} method.
	 *
	 * The method provides the offset as reference, if the method returns &lt;tt&gt;NULL&lt;/tt&gt; it
	 * means that the offset and value must be passed to the inherited
	 * {@link ArrayObject::OffsetUnset()}; if the method returns any other value, this means
	 * that the inherited {@link ArrayObject::OffsetUnset()} should be skipped.
	 *
	 * In this class we do nothing.
	 *
	 * @param reference				$theOffset			Offset reference.
	 *
	 * @access protected
	 * @return mixed				&lt;tt&gt;NULL&lt;/tt&gt; delete offset value, other, return.
	 */
	protected function preOffsetUnset( &amp;$theOffset )					{	return NULL;	}

	 
	/*===================================================================================
	 *	postOffsetUnset																	*
	 *==================================================================================*/

	/**
	 * Handle offset after deleting it
	 *
	 * This method can be used to manage the object after calling the
	 * {@link ArrayObject::OffsetUnset()} method.
	 *
	 * In this class we do nothing.
	 *
	 * @param reference				$theOffset			Offset reference.
	 *
	 * @access protected
	 */
	protected function postOffsetUnset( &amp;$theOffset )									   {}

	 

} // class ContainerObject.


?&gt;
</pre>
        <script type="text/javascript">
             SyntaxHighlighter.all();
             jQuery('.gutter div').each(function(key, data){
                jQuery(data).prepend('<a name="L'+jQuery(data).text()+'"/>');
             });
        </script>
    </body>
</html>