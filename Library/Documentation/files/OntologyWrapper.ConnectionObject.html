<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Ontology Wrapper</title><link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet"></link><link rel="stylesheet" href="../css/template.css" type="text/css"></link><script type="text/javascript" src="../js/jquery-1.7.1.min.js"></script><script type="text/javascript" src="../js/bootstrap.min.js"></script><script type="text/javascript" src="../js/template.js"></script></head><body><div id="content"><h1 class="file">OntologyWrapper/ConnectionObject.php<a href="../source/OntologyWrapper/ConnectionObject.php.html" role="button" class="pull-right btn btn-default"><i class="fa fa-2x fa-code"></i></a></h1><div id="file-nav-box"><div id="file-nav-options">
              Show:
              <img src="../images/icons/visibility_public.png" alt="Public" id="show-public"></img><img src="../images/icons/visibility_protected.png" alt="Protected" id="show-protected"></img><img src="../images/icons/visibility_private.png" alt="Private" id="show-private"></img><span class="attribute" id="show-inherited">inherited</span></div><div id="file-nav-container"><ul id="file-nav"><li><a href="#classes"><img src="../images/icons/class.png" alt="Class" height="14"></img>
                          Classes
                      </a><ul><li><a href="#\OntologyWrapper\ConnectionObject">\OntologyWrapper\ConnectionObject</a></li></ul></li></ul><div style="clear: left;"></div></div><div id="file-nav-tab">
              Table of Contents
          </div></div><a name="top" class="anchor"></a><div id="file-description"><div class="short-description">ConnectionObject.php</div><div class="long-description">This file contains the definition of the {@link ConnectionObject} class.</div></div><a name="classes" class="anchor"></a><a id="\OntologyWrapper\ConnectionObject" class="anchor"></a><h2 class="class">\OntologyWrapper\ConnectionObject<div class="to-top"><a href="#top">jump to top</a></div></h2><div class="class"><small class="package"><b>Package: </b>Default</small><div class="short-description">Connection object</div><div class="long-description">This <i>abstract</i> class is the ancestor of all classes representing connection
instances, such as servers, databases and collections.

The main purpose of this class is to wrap a common interface around concrete instances of
specific server, database or collection or engines.

The class features the following properties:

<ul>
<li><tt>{@link $mDSN}</tt>: The <i>data source name</i>, it is an URL that represents
	the connection string.
<li><tt>{@link $mConnection}</tt>: The <i>connection resource</i>, it represents the
	native connection.
<li><tt>{@link $mParent}</tt>: The <i>parent connection</i>, it represents the instance
	derived from this class that instantiated the current object.
</ul>

The object is instantiated by providing a parameter that may either be a connection URL,
such as a string that may be parsed by the {@link parse_url()} function, or an array
containing the connection parameters.

The public interface of this class, as well as for many other abstract classes, is
implemented as templates in which protected methods do the actual work, so derived
concrete classes should only need to implement the protected interface.

This class declares three methods for managing the connection:

<ul>
<li><tt>{@link isConnected()}</tt>: Returns <tt>TRUE</tt> if the connection is open.
<li><tt>{@link openConnection()}</tt>: Create and open the connection.
<li><tt>{@link closeConnection()}</tt>: Close and reset the connection.
</ul>

When the object goes out of context it will close the connection, if open, and re-open it
once it gets back into context:

<ul>
<li><tt>{@link __sleep()}</tt>: This method will close the connection, if open, and
	set the {@link $mConnection connection} property to <tt>TRUE</tt> as an indication
	that the connection must be opened once the object gets back into scope.
<li><tt>{@link __wakeup()}</tt>: This method will open the connection, if the object
	went out of scope while the connection was open.
</ul>

The class provides accessor methods for the object properties: the {@link $mDSN} data
member can be managed with the {@link DSN()} method, the {@link $mConnection} data
member can be retrieved with the {@link Connection()} method and the {@link $mParent}
data member can be retrieved with the {@link Parent()} method.

When setting the connection string, {@link DSN()}, the object's connection parameters
will be synchronised. When setting offsets, the data source name will not be changed.
When the connection is opened, {@link openConnection()}, the data source name will be
re-constituted using the object's offsets. This means that the object offsets represent
the actual connection parameters, although setting the DSN will reset these parameters to
match the connection URL.

When the connection is {@link isConnected() open}, any attempt to modify the object
offsets will raise an exception: this is to prevent changing the connection properties
while connected.

In this class we make use of the {@link Status} trait, here we set the
{@link isDirty()} flag whenever we modify an object offset, and we reset it whenever we
open the connection; we reset the status bitfield data member after calling the parent
constructor.

This object represents the building block for all concrete instances that represent
servers, databases, data collections and caches.
+
+ When parsing the data source name, using the {@link parse_url()} function,, this class
will perform the following associations:

<ul>
<li><tt>scheme</tt>: <tt>{@link kTAG_CONN_PROTOCOL}</tt>. This corresponds to the server
	and database protocols, which must be the same.
<li><tt>host</tt>: <tt>{@link kTAG_CONN_HOST}</tt>. This corresponds to the server
	object connection host.
<li><tt>port</tt>: <tt>{@link kTAG_CONN_PORT}</tt>. This corresponds to the server
	object connection port.
<li><tt>user</tt>: <tt>{@link kTAG_CONN_USER}</tt>. This corresponds to the server
	object connection user code.
<li><tt>pass</tt>: <tt>{@link kTAG_CONN_PASS}</tt>. This corresponds to the server
	object connection user password.
<li><tt>path</tt>: <tt>{@link kTAG_CONN_BASE}</tt>. This corresponds to the database
	object name.
<li><tt>fragment</tt>: <tt>{@link kTAG_CONN_COLL}</tt>. This corresponds to the
	collection object name.
</ul>

The above associations are stored in the object's offsets, which means that a collection
will hold its database name and all the parameters of the server connection.</div><dl class="class-info"><dt>Parent(s)</dt><dd><a href="../files/OntologyWrapper.OntologyObject.html#\OntologyWrapper\OntologyObject">\OntologyWrapper\OntologyObject</a>
            &lt;
            <a href="../files/OntologyWrapper.ContainerObject.html#\OntologyWrapper\ContainerObject" style="color: gray; font-size: 0.8em
                ">\OntologyWrapper\ContainerObject</a>
            &lt;
            \ArrayObject</dd><dt>Children</dt><dd><a href="../files/OntologyWrapper.DatabaseObject.html#\OntologyWrapper\DatabaseObject">\OntologyWrapper\DatabaseObject</a></dd><dd><a href="../files/OntologyWrapper.ServerObject.html#\OntologyWrapper\ServerObject">\OntologyWrapper\ServerObject</a></dd><dd><a href="../files/OntologyWrapper.CollectionObject.html#\OntologyWrapper\CollectionObject">\OntologyWrapper\CollectionObject</a></dd><dt>Author</dt><dd><a href="mailto:m.skofic@cgiar.org">Milko A. Škofič</a>
         
    </dd><dt>Version</dt><dd>1.00 16/01/2014
         
    </dd></dl><h3>Properties</h3><div><a id="\OntologyWrapper\ConnectionObject::$mConnection" class="anchor"></a><div class="property protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png" alt="&gt;"></img><img src="../images/icons/arrow_down.png" alt="V" style="display: none;"></img></a><code class="title"><img src="../images/icons/property.png" alt="Property"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img>mixed <span class="highlight">$mConnection</span> = NULL</code><div class="description"><div class="short-description">Connection resource.</div></div><div class="code-tabs"><div class="long-description">This data member holds the <i>connection resource</i>, or <i>native connection</i>,
this property represents the actual connection resource.</div><strong>Default value</strong><code>NULL</code><strong>Details</strong><dl class="property-info"><dt>Type</dt><dd>mixed</dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::$mDSN" class="anchor"></a><div class="property protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png" alt="&gt;"></img><img src="../images/icons/arrow_down.png" alt="V" style="display: none;"></img></a><code class="title"><img src="../images/icons/property.png" alt="Property"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img>string <span class="highlight">$mDSN</span> = NULL</code><div class="description"><div class="short-description">Data source name.</div></div><div class="code-tabs"><div class="long-description">This data member holds the <i>data source name</i>, or <tt>DSN</tt>, it is an URL
connection string that should be compatible with the {@link parse_url()} function.
This string should hold all the connection parameters.</div><strong>Default value</strong><code>NULL</code><strong>Details</strong><dl class="property-info"><dt>Type</dt><dd>string</dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::$mParent" class="anchor"></a><div class="property protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png" alt="&gt;"></img><img src="../images/icons/arrow_down.png" alt="V" style="display: none;"></img></a><code class="title"><img src="../images/icons/property.png" alt="Property"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img>\OntologyWrapper\ConnectionObject <span class="highlight">$mParent</span> = NULL</code><div class="description"><div class="short-description">Parent connection.</div></div><div class="code-tabs"><div class="long-description">This data member holds the <i>parent connection object</i>, this value should be an
instance derived from this class which is used to instantiate the current object's
connection resource.</div><strong>Default value</strong><code>NULL</code><strong>Details</strong><dl class="property-info"><dt>Type</dt><dd><a href="../files/ConnectionObject.html">\OntologyWrapper\ConnectionObject</a></dd></dl></div><div class="clear"></div></div></div><h3>Methods</h3><div><a id="\OntologyWrapper\ConnectionObject::Connection()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">Connection</span><span class="nb-faded-text">()</span> : mixed</code><div class="description"><p class="short_description">Return connection resource.</p></div><div class="code-tabs"><div class="long-description">This method can be used to retrieve the <i>connection resource</i>, this method is
read-only, since the connection resource should only be set by the object's
connection methods.

The connection resource represents the native connection.</div><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>mixed</td><td>Connection resource.</td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>public
         
    </dd><dt>See</dt><dd><a href="../files/
                         \OntologyWrapper\$mConnection"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::DSN()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">DSN</span><span class="nb-faded-text">(mixed $theValue = NULL, boolean $getOld = FALSE, boolean $doSync = TRUE)</span> : mixed</code><div class="description"><p class="short_description">Manage data source name</p></div><div class="code-tabs"><div class="long-description">This method can be used to manage the <i>data source name</i>, it accepts a parameter
which represents either the data source name or the requested operation, depending on
its value:

<ul>
<li><tt>NULL</tt>: Return the current value.
<li><tt>FALSE</tt>: Delete the current value.
<li><i>other</i>: Set the value with the provided parameter.
</ul>

The second parameter is a boolean which if <tt>TRUE</tt> will return the <i>old</i>
value when replacing or resetting; if <tt>FALSE</tt>, it will return the current
value.

The last parameter is a switch that determines whether the object offsets should be
synchronised: if <tt>TRUE</tt>, the object offsets will be reset and populated with
the elements parsed from the data source name; if <tt>FALSE</tt>, the object offsets
will not be modified. This parameter is set to <tt>FALSE</tt> by the constructor,
since using all offsets may produce an invalid URL and is <tt>TRUE</tt> by default,
since setting a connection URL generally means changing the parameters.

Whenever a new value is set or the value is deleted, the method will synchronise the
object offsets.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$theValue</th><td>mixed</td><td><em><p>Data source name or operation.</p></em></td></tr><tr><th>$getOld</th><td>boolean</td><td><em><tt>TRUE</tt> get old value.</em></td></tr><tr><th>$doSync</th><td>boolean</td><td><em><tt>TRUE</tt> will sync offsets.</em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>mixed</td><td>&lt;i&gt;New&lt;/i&gt; or &lt;i&gt;old&lt;/i&gt; data source name.</td></tr></table><strong>Throws</strong><table class="argument-info"><thead><tr><th>Exception</th><th>Description</th></tr></thead><tr><td><a href="../files/Exception.html">\OntologyWrapper\Exception</a></td><td><em></em></td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>public
         
    </dd><dt>See</dt><dd><a href="../files/
                         \OntologyWrapper\$mDSN"></a>
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         isConnected()"></a>
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         manageProperty()"></a>
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         parseDSN()"></a>
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         isDirty()"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::Parent()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">Parent</span><span class="nb-faded-text">()</span> : <a href="../files/ConnectionObject.html">\OntologyWrapper\ConnectionObject</a></code><div class="description"><p class="short_description">Return connection parent.</p></div><div class="code-tabs"><div class="long-description">This method can be used to retrieve the <i>parent connection</i>, this method is
read-only, since the connection parent can only be set by the constructor and cannot
be changed once the object has been instantiated.

The connection parent represents the connection creator as the server for a database.</div><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td><a href="../files/ConnectionObject.html">\OntologyWrapper\ConnectionObject</a></td><td>Parent connection.</td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>public
         
    </dd><dt>See</dt><dd><a href="../files/
                         \OntologyWrapper\$mParent"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::__construct()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">__construct</span><span class="nb-faded-text">(mixed $theParameter = NULL, <a href="../files/ConnectionObject.html">\OntologyWrapper\ConnectionObject</a> $theParent = NULL)</span> : void</code><div class="description"><p class="short_description">Instantiate class.</p></div><div class="code-tabs"><div class="long-description">The object may be instantiated as an empty object, by omitting both parameters; with
a <i>data source name</i> in the form of a connection URL; or by providing an array
of tag/value parameters which will constitute the object's offsets.

If you provide a data source name, this must be parsable by the {@link parse_url()}
function, if this is not the case, you should use the parameters list.

If the first parameter was provided, the method will synchronise both the data source
name and the connection parameters.

The second parameter represents the <i>connection parent</i>, it must be an instance
derived from this class and will only be set by the constructor.

When overloading the constructor in derived classes you should always first call the
parent method and then perform custom actions.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$theParameter</th><td>mixed</td><td><em><p>Data source name or parameters.</p></em></td></tr><tr><th>$theParent</th><td><a href="../files/ConnectionObject.html">\OntologyWrapper\ConnectionObject</a></td><td><em><p>Connection parent.</p></em></td></tr></table><strong>Throws</strong><table class="argument-info"><thead><tr><th>Exception</th><th>Description</th></tr></thead><tr><td><a href="../files/Exception.html">\OntologyWrapper\Exception</a></td><td><em></em></td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>public
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         DSN()"></a>
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         parseOffsets()"></a>
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         statusReset()"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::__destruct()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">__destruct</span><span class="nb-faded-text">()</span> : void</code><div class="description"><p class="short_description">Destruct instance.</p></div><div class="code-tabs"><div class="long-description">The destructor will close the connection if open.</div><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>public
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         closeConnection()"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::__sleep()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">__sleep</span><span class="nb-faded-text">()</span> : void</code><div class="description"><p class="short_description">Sleep</p></div><div class="code-tabs"><div class="long-description">This method will close the connection and replace the connection resource with
<tt>TRUE</tt> if the connection was open.</div><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>public
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         isConnected()"></a>
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         closeConnection()"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::__toString()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">__toString</span><span class="nb-faded-text">()</span> : string</code><div class="description"><p class="short_description"><h4>Return connection name</h4></p></div><div class="code-tabs"><div class="long-description">In this class we consider the data source name as the global identifier; here we
return it as is, in derived classes you should be careful to shadow sensitive data.

Note that this method cannot return the <tt>NULL</tt> value, which means that it
cannot be used until there is a data source name for the object.</div><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>string</td><td>The global identifier.</td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>public
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::__wakeup()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">__wakeup</span><span class="nb-faded-text">()</span> : void</code><div class="description"><p class="short_description">Wake up</p></div><div class="code-tabs"><div class="long-description">This method will re-open the connection if it was closed by the {@link __sleep()}
method.</div><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>public
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         openConnection()"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::closeConnection()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">closeConnection</span><span class="nb-faded-text">()</span> : boolean</code><div class="description"><p class="short_description">Close connection</p></div><div class="code-tabs"><div class="long-description">If the connection is open, this method will close the connection and reset the
{@link Connection} data member.

The method will return <tt>TRUE</tt> if the connection was open and <tt>FALSE</tt> if
not.</div><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>boolean</td><td>&lt;tt&gt;TRUE&lt;/tt&gt; if closed, &lt;tt&gt;FALSE&lt;/tt&gt; if was closed.</td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>public
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         isConnected()"></a>
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         connectionClose()"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::connectionClose()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">connectionClose</span><span class="nb-faded-text">()</span> : void</code><div class="description"><span class="attribute">abstract</span><p class="short_description">Open connection</p></div><div class="code-tabs"><div class="long-description">This method should close the actual connection, in this class the method is virtual.

This method expects the caller to have checked whether the connection is open.

If the operation fails, the method should raise an exception.</div><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>protected
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::connectionOpen()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">connectionOpen</span><span class="nb-faded-text">()</span> : mixed</code><div class="description"><span class="attribute">abstract</span><p class="short_description">Open connection</p></div><div class="code-tabs"><div class="long-description">This method should open the actual connection and set the {@link mConnection} data
member; in this class the method is virtual.

This method expects the caller to have checked whether the connection is already
open.

If the operation fails, the method should raise an exception.</div><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>mixed</td><td>The native connection.</td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>protected
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::isConnected()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">isConnected</span><span class="nb-faded-text">()</span> : boolean</code><div class="description"><p class="short_description">Check if connection is open</p></div><div class="code-tabs"><div class="long-description">This method returns a boolean flag indicating whether the connection is open or not.</div><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>boolean</td><td>&lt;tt&gt;TRUE&lt;/tt&gt; is open.</td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>public
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::loadDSNParameter()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">loadDSNParameter</span><span class="nb-faded-text">(<a href="../files/reference.html">\OntologyWrapper\reference</a> $theParameters, string $theKey, string $theValue = NULL)</span> : void</code><div class="description"><p class="short_description">Load connection parameters from DSN</p></div><div class="code-tabs"><div class="long-description">This method will load the parameters parsed from the data source name into the
current object's offsets, it expects three parameters:

<ul>
<li><b>$theParameters</b>: This array is the result of the {@link parse_url()}
	function on the data source name:
 <ul>
	<li><tt><code>scheme</code></tt>: We set it in {@link kTAG_CONN_PROTOCOL}.
	<li><tt><code>host</code></tt>: We set it in {@link kTAG_CONN_HOST}.
	<li><tt><code>port</code></tt>: We set it in {@link kTAG_CONN_PORT}.
	<li><tt><code>user</code></tt>: We set it in {@link kTAG_CONN_USER}.
	<li><tt><code>pass</code></tt>: We set it in {@link kTAG_CONN_PASS}.
	<li><tt><code>path</code></tt>: We set it in {@link kTAG_CONN_BASE}.
	<li><tt><code>fragment</code></tt>: We set it in {@link kTAG_CONN_COLL}.
	<li><tt><code>query</code></tt>: We load the key/value pairs into
		{@link kTAG_CONN_OPTS} array.
 </ul>
<li><b>$theKey</b>: This parameter represents the offset.
<li><b>$theValue</b>: This parameter represents the offset value.
</ul>

This is the method that derived classes may overload to customise the parameters.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$theParameters</th><td><a href="../files/reference.html">\OntologyWrapper\reference</a></td><td><em><p>Original parameters list.</p></em></td></tr><tr><th>$theKey</th><td>string</td><td><em><p>Parameter key.</p></em></td></tr><tr><th>$theValue</th><td>string</td><td><em><p>Parameter value.</p></em></td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>protected
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::openConnection()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">openConnection</span><span class="nb-faded-text">()</span> : mixed</code><div class="description"><p class="short_description">Open connection</p></div><div class="code-tabs"><div class="long-description">This method can be used to create and open the connection.

We first check if the connection is already set: if so we do nothing.

We call the protected {@link connectionOpen()} method which will open the connection
and return the connection resource which will be set in the data member,
{@link mConnection}.

The method will return the connection resource.</div><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>mixed</td><td>Depends on implementation.</td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>public
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         isConnected()"></a>
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         isDirty()"></a>
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         DSN()"></a>
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         parseOffsets()"></a>
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         connectionOpen()"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::parseDSN()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">parseDSN</span><span class="nb-faded-text">(string $theDSN)</span> : void</code><div class="description"><p class="short_description">Parse data source name</p></div><div class="code-tabs"><div class="long-description">This method will parse the provided data source name, extract the connection
parameters and set them in the current object.

The method will make use of the {@link parse_url()} function and pass each key/value
pair to the protected {@link loadDSNParameter()} method which has the responsibility
of matching the {@link parse_url()} keys to {@link Tag} instances.

If the {@link parse_url()} function fails to parse the DSN, the method will raise an
exception.

Derived classes should overload the {@link loadDSNParameter()} method.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$theDSN</th><td>string</td><td><em><p>Data source name.</p></em></td></tr></table><strong>Throws</strong><table class="argument-info"><thead><tr><th>Exception</th><th>Description</th></tr></thead><tr><td><a href="../files/Exception.html">\OntologyWrapper\Exception</a></td><td><em></em></td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>protected
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         loadDSNParameter()"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::parseOffset()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">parseOffset</span><span class="nb-faded-text">(<a href="../files/reference.html">\OntologyWrapper\reference</a> $theParameters, string $theOffset, mixed $theValue)</span> : void</code><div class="description"><p class="short_description">Parse offset</p></div><div class="code-tabs"><div class="long-description">This method will parse the provided offset and populate the provided parameters.
The main duty is to load the offset values into the provided parameters array so to
create the same result as the {@link parse_url()} function.

The resulting array can have the following elements:

<ul>
<li><tt><code>scheme</code></tt>: The protocol or scheme.
<li><tt><code>host</code></tt>: The connection host.
<li><tt><code>port</code></tt>: The connection port.
<li><tt><code>user</code></tt>: The user code.
<li><tt><code>pass</code></tt>: The user password.
<li><tt><code>path</code></tt>: The connection path.
<li><tt><code>query</code></tt>: The connection options.
<li><tt><code>fragment</code></tt>: The URL fragment.
</ul>

In this class we handle the following offsets:

<ul>
<li><tt>{@link kTAG_CONN_PROTOCOL}</tt>: The <code>scheme</code>.
<li><tt>{@link kTAG_CONN_HOST}</tt>: The connection <code>host</code>.
<li><tt>{@link kTAG_CONN_PORT}</tt>: The connection <code>port</code>.
<li><tt>{@link kTAG_CONN_USER}</tt>: The <code>user</code> code.
<li><tt>{@link kTAG_CONN_PASS}</tt>: The user <code>pass</code>word.
<li><tt>{@link kTAG_CONN_BASE}</tt>: The user <code>path</code>word.
<li><tt>{@link kTAG_CONN_COLL}</tt>: The user <code>fragment</code>word.
<li><tt>{@link kTAG_CONN_OPTS}</tt>: The connection options, <code>query</code>.
</ul>

Derived classes can overload this method to customise the parameters.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$theParameters</th><td><a href="../files/reference.html">\OntologyWrapper\reference</a></td><td><em><p>Receives parsed offset.</p></em></td></tr><tr><th>$theOffset</th><td>string</td><td><em><p>Offset.</p></em></td></tr><tr><th>$theValue</th><td>mixed</td><td><em><p>Offset value.</p></em></td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>protected
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         parseOption()"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::parseOffsets()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">parseOffsets</span><span class="nb-faded-text">(array $theOffsets)</span> : mixed</code><div class="description"><p class="short_description">Parse connection parameters</p></div><div class="code-tabs"><div class="long-description">This method will parse the provided key/value array and generate a connection URL.

The method will iterate the provided offsets and feed them to the protected
{@link parseOffset()} method which will populate an array structured as the result of
the {@link parse_url()} function, it will be the duty of this method to generate a
data source name from that array.

Derived classes should overload the called methods and not this one.

If the resulting data source name is empty, the method will return <tt>FALSE</tt>.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$theOffsets</th><td>array</td><td><em><p>Offsets.</p></em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>mixed</td><td>Data source name or &lt;tt&gt;FALSE&lt;/tt&gt; if empty.</td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>protected
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         parseOffset()"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::parseOption()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">parseOption</span><span class="nb-faded-text">(<a href="../files/reference.html">\OntologyWrapper\reference</a> $theParameters, string $theOption, mixed $theValue)</span> : void</code><div class="description"><p class="short_description">Parse option</p></div><div class="code-tabs"><div class="long-description">This method will parse the provided option and populate the query parameters.
The main duty is to load the option into the <code>query</code> element of the
provided parameters list as the result of the {@link parse_url()} function.

In this class we load what we find.

Derived classes can overload this method to customise the options.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$theParameters</th><td><a href="../files/reference.html">\OntologyWrapper\reference</a></td><td><em><p>Receives parsed offset.</p></em></td></tr><tr><th>$theOption</th><td>string</td><td><em><p>Option.</p></em></td></tr><tr><th>$theValue</th><td>mixed</td><td><em><p>Option value.</p></em></td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>protected
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::postOffsetSet()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">postOffsetSet</span><span class="nb-faded-text">(<a href="../files/reference.html">\OntologyWrapper\reference</a> $theOffset, <a href="../files/reference.html">\OntologyWrapper\reference</a> $theValue)</span> : void</code><div class="description"><p class="short_description">Handle offset and value after setting it</p></div><div class="code-tabs"><div class="long-description">We set the {@link isDirty()} status.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$theOffset</th><td><a href="../files/reference.html">\OntologyWrapper\reference</a></td><td><em><p>Offset reference.</p></em></td></tr><tr><th>$theValue</th><td><a href="../files/reference.html">\OntologyWrapper\reference</a></td><td><em><p>Offset value reference.</p></em></td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>protected
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         isDirty()"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::postOffsetUnset()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">postOffsetUnset</span><span class="nb-faded-text">(<a href="../files/reference.html">\OntologyWrapper\reference</a> $theOffset)</span> : void</code><div class="description"><p class="short_description">Handle offset and value after deleting it</p></div><div class="code-tabs"><div class="long-description">We set the {@link isDirty()} status.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$theOffset</th><td><a href="../files/reference.html">\OntologyWrapper\reference</a></td><td><em><p>Offset reference.</p></em></td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>protected
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         isDirty()"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::preOffsetSet()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">preOffsetSet</span><span class="nb-faded-text">(<a href="../files/reference.html">\OntologyWrapper\reference</a> $theOffset, <a href="../files/reference.html">\OntologyWrapper\reference</a> $theValue)</span> : mixed</code><div class="description"><p class="short_description">Handle offset and value before setting it</p></div><div class="code-tabs"><div class="long-description">We overload this method to prevent setting values while the connection is open.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$theOffset</th><td><a href="../files/reference.html">\OntologyWrapper\reference</a></td><td><em><p>Offset reference.</p></em></td></tr><tr><th>$theValue</th><td><a href="../files/reference.html">\OntologyWrapper\reference</a></td><td><em><p>Offset value reference.</p></em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>mixed</td><td>&lt;tt&gt;NULL&lt;/tt&gt; set offset value, other, return.</td></tr></table><strong>Throws</strong><table class="argument-info"><thead><tr><th>Exception</th><th>Description</th></tr></thead><tr><td><a href="../files/Exception.html">\OntologyWrapper\Exception</a></td><td><em></em></td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>protected
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         isConnected()"></a>
         
    </dd></dl></div><div class="clear"></div></div><a id="\OntologyWrapper\ConnectionObject::preOffsetUnset()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">preOffsetUnset</span><span class="nb-faded-text">(<a href="../files/reference.html">\OntologyWrapper\reference</a> $theOffset)</span> : mixed</code><div class="description"><p class="short_description">Handle offset and value before deleting it</p></div><div class="code-tabs"><div class="long-description">We overload this method to prevent deleting values while the connection is open.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$theOffset</th><td><a href="../files/reference.html">\OntologyWrapper\reference</a></td><td><em><p>Offset reference.</p></em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>mixed</td><td>&lt;tt&gt;NULL&lt;/tt&gt; delete offset value, other, return.</td></tr></table><strong>Details</strong><dl class="function-info"><dt>Access</dt><dd>protected
         
    </dd><dt>Uses</dt><dd><a href="../files/
                         isConnected()"></a>
         
    </dd></dl></div><div class="clear"></div></div></div></div></div><small class="footer">
            Documentation was generated by
            <a href="http://phpdoc.org">phpDocumentor
                2.2.0
</a>.
        </small></body></html>
